<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/white.css" rel="stylesheet">
    <style>
        .reveal .slides {
            text-align: left;
        }
        .reveal h1 {
            font-size: 2.5em;
            margin-bottom: 0.5em;
        }
        .reveal h2 {
            font-size: 2em;
            margin-bottom: 0.5em;
        }
        .reveal p {
            font-size: 1.2em;
            margin-bottom: 0.5em;
        }
        .reveal ul {
            font-size: 1.2em;
            margin-bottom: 1em;
        }
        .reveal .chart-container {
            width: 100%;
            height: 400px;
            margin: 1em 0;
        }
        .reveal .highlight {
            color: #007bff;
            font-weight: bold;
        }
        .reveal .footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1em;
            font-size: 0.8em;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            <!-- Title Slide -->
            <section>
                <h1>{{ title }}</h1>
                <p>Generated on {{ date }}</p>
                <div class="footer">
                    <p>Analysis Report | Confidential</p>
                </div>
            </section>

            <!-- Executive Summary -->
            <section>
                <h2>Executive Summary</h2>
                <div class="content">
                    {{ executive_summary | safe }}
                </div>
            </section>

            <!-- Forecast Analysis -->
            <section>
                <h2>Forecast Analysis</h2>
                <div class="content">
                    <h3>Key Metrics</h3>
                    <ul>
                        {% for metric, value in forecast_results.metrics.items() %}
                        <li>{{ metric }}: {{ "%.2f"|format(value) }}</li>
                        {% endfor %}
                    </ul>
                    <div class="chart-container" id="forecast-chart"></div>
                </div>
            </section>

            <!-- Market Insights -->
            <section>
                <h2>Market Insights</h2>
                <div class="content">
                    <h3>Key Trends</h3>
                    <ul>
                        {% for insight in market_insights.key_insights %}
                        <li>{{ insight }}</li>
                        {% endfor %}
                    </ul>
                    <div class="chart-container" id="market-trends-chart"></div>
                </div>
            </section>

            <!-- Simulation Results -->
            <section>
                <h2>Simulation Results</h2>
                <div class="content">
                    <h3>Scenario Analysis</h3>
                    <ul>
                        {% for scenario in simulation_results.scenarios %}
                        <li>Scenario {{ scenario.scenario_id }}:
                            <ul>
                                <li>Feature Change: {{ "%.1f"|format(scenario.feature_change * 100) }}%</li>
                                <li>Mean Outcome: {{ "%.2f"|format(scenario.predictions.mean) }}</li>
                                <li>Confidence Interval: [{{ "%.2f"|format(scenario.confidence_interval.lower) }}, 
                                                         {{ "%.2f"|format(scenario.confidence_interval.upper) }}]</li>
                            </ul>
                        </li>
                        {% endfor %}
                    </ul>
                    <div class="chart-container" id="simulation-chart"></div>
                </div>
            </section>

            <!-- Recommendations -->
            <section>
                <h2>Recommendations</h2>
                <div class="content">
                    <h3>Key Actions</h3>
                    <ul>
                        {% for recommendation in recommendations %}
                        <li>{{ recommendation }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </section>

            <!-- Thank You -->
            <section>
                <h2>Thank You</h2>
                <p>Questions?</p>
                <div class="footer">
                    <p>Analysis Report | Confidential</p>
                </div>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/highlight/highlight.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Initialize Reveal.js
        Reveal.initialize({
            hash: true,
            plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
        });

        // Create charts
        function createForecastChart() {
            const ctx = document.getElementById('forecast-chart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: {{ forecast_results.dates | tojson }},
                    datasets: [{
                        label: 'Forecast',
                        data: {{ forecast_results.predictions | tojson }},
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function createMarketTrendsChart() {
            const ctx = document.getElementById('market-trends-chart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: {{ market_insights.trends[0].dates | tojson }},
                    datasets: {{ market_insights.trends | tojson }}.map(trend => ({
                        label: trend.name,
                        data: trend.values,
                        borderColor: trend.color || 'rgb(75, 192, 192)',
                        tension: 0.1
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function createSimulationChart() {
            const ctx = document.getElementById('simulation-chart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: {{ simulation_results.scenarios | map(attribute='feature_change') | map('multiply', 100) | list | tojson }},
                    datasets: [{
                        label: 'Mean Outcome',
                        data: {{ simulation_results.scenarios | map(attribute='predictions.mean') | list | tojson }},
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgb(75, 192, 192)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Create charts when the presentation is ready
        Reveal.on('ready', function() {
            createForecastChart();
            createMarketTrendsChart();
            createSimulationChart();
        });
    </script>
</body>
</html> 